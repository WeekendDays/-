fp=2000;
wp=2*pi*fp;
fs=5000;
ws=2*pi*fs;
rp=1;  
rs=20;
[N,Wn]=buttord(wp,ws,rp,rs,'s');
disp(N);
[b,a]=butter(N,Wn,'s');
figure(1);
freqs(b,a);
[N,Wn]=cheb1ord(wp,ws,rp,rs,'s');
disp(N);
[z,p,k]=cheb1ap(N,rp);
b=k*real(poly(z));
a=real(poly(p));
[H,omega]=freqs(b,a);
figure(2);
subplot(321);
plot(omega*Wn/(2*pi),abs(H));grid;
axis([0,8000,0,1.1]);ylabel('幅度');xlabel('f(Hz)');
title('切比雪夫I型幅频响应');
subplot(322);
plot(omega*Wn/(2*pi),angle(H));grid;
axis([0,8000,-4,4]);ylabel('相位');xlabel('f(Hz)');
title('切比雪夫I型相频响应');

[N,Wn]=cheb2ord(wp,ws,rp,rs,'s');
disp(N);
[z,p,k]=cheb2ap(N,rs);
b=k*real(poly(z));
a=real(poly(p));
[H,omega]=freqs(b,a);
subplot(323);
plot(omega*Wn/(2*pi),abs(H));grid;
axis([0,8000,0,1.1]);ylabel('幅度');xlabel('f(Hz)');
title('切比雪夫II型幅频响应');
subplot(324);
plot(omega*Wn/(2*pi),angle(H));grid;
axis([0,8000,-4,4]);ylabel('相位');xlabel('f(Hz)');
title('切比雪夫II型相频响应');

[N,Wn]=ellipord(wp,ws,rp,rs,'s');
disp(N);
[z,p,k]=ellipap(N,rp,rs);
b=k*real(poly(z));
a=real(poly(p));
[H,omega]=freqs(b,a);
subplot(325);
plot(omega*Wn/(2*pi),abs(H));grid;
axis([0,8000,0,1.1]);ylabel('幅度');xlabel('f(Hz)');
title('椭圆原型低通滤波器的幅频响应');
subplot(326);
plot(omega*Wn/(2*pi),angle(H));grid;
axis([0,8000,-4,4]);ylabel('相位');xlabel('f(Hz)');
title('椭圆原型低通滤波器的相频响应');

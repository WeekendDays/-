fp1=10; wp1=2*pi*fp1;
fp2=35; wp2=2*pi*fp2;
omegap=[wp1 wp2];
fs1=15; ws1=2*pi*fs1;
fs2=30; ws2=2*pi*fs2;
omegas=[ws1 ws2];
bw=wp2-wp1;%带宽
w0=sqrt(ws1*ws2);%中心频率
rp=3; rs=30;

[N,~]=buttord(omegap,omegas,rp,rs,'s');
[z0,p0,k0]=buttap(N);
b0=k0*real(poly(z0));
a0=real(poly(p0));
[H,omega0]=freqs(b0,a0);
dbH=20*log10((abs(H)+eps)/max(abs(H)));
[b1,a1]=lp2bs(b0,a0,w0,bw);
[H1,omega1]=freqs(b1,a1);
dbH1=20*log10((abs(H1)+eps)/max(abs(H1)));

figure(1);
subplot(221);
plot(omega0/(2*pi),dbH);grid;
axis([0,1,-50,1]);
title('归一化模拟低通原型幅度响应');
subplot(222);
plot(omega0/(2*pi),angle(H));grid;
axis([0,1,-4,4]);
title('归一化模拟低通原型相位响应');
subplot(223);
plot(omega1/(2*pi),dbH1);grid;
axis([0,60,-60,1]);
title('实际模拟带阻幅度响应');
subplot(224);
plot(omega1/(2*pi),angle(H1));grid;
axis([0,60,-4,4]);
title('实际模拟带阻相频响应');

[N,~]=cheb1ord(omegap,omegas,rp,rs,'s');
[z0,p0,k0]=cheb1ap(N,rp);
b0=k0*real(poly(z0));
a0=real(poly(p0));
[H,omega0]=freqs(b0,a0);
dbH=20*log10((abs(H)+eps)/max(abs(H)));
[b1,a1]=lp2bs(b0,a0,w0,bw);
[H1,omega1]=freqs(b1,a1);
dbH1=20*log10((abs(H1)+eps)/max(abs(H1)));

figure(2);
subplot(221);
plot(omega0/(2*pi),dbH);grid;
axis([0,1,-50,1]);
title('归一化模拟低通原型幅度响应');
subplot(222);
plot(omega0/(2*pi),angle(H));grid;
axis([0,1,-4,4]);
title('归一化模拟低通原型相位响应');
subplot(223);
plot(omega1/(2*pi),dbH1);grid;
axis([0,60,-60,1]);
title('实际模拟带阻幅度响应');
subplot(224);
plot(omega1/(2*pi),angle(H1));grid;
axis([0,60,-4,4]);
title('实际模拟带阻相频响应');

[N,~]=cheb2ord(omegap,omegas,rp,rs,'s');
[z0,p0,k0]=cheb2ap(N,rp);
b0=k0*real(poly(z0));
a0=real(poly(p0));
[H,omega0]=freqs(b0,a0);
dbH=20*log10((abs(H)+eps)/max(abs(H)));
[b1,a1]=lp2bs(b0,a0,w0,bw);
[H1,omega1]=freqs(b1,a1);
dbH1=20*log10((abs(H1)+eps)/max(abs(H1)));

figure(3);
subplot(221);
plot(omega0/(2*pi),dbH);grid;
axis([0,1,-50,1]);
title('归一化模拟低通原型幅度响应');
subplot(222);
plot(omega0/(2*pi),angle(H));grid;
axis([0,1,-4,4]);
title('归一化模拟低通原型相位响应');
subplot(223);
plot(omega1/(2*pi),dbH1);grid;
axis([0,60,-60,1]);
title('实际模拟带阻幅度响应');
subplot(224);
plot(omega1/(2*pi),angle(H1));grid;
axis([0,60,-4,4]);
title('实际模拟带阻相频响应');

[N,omegac]=ellipord(omegap,omegas,rp,rs,'s');
[z0,p0,k0]=ellipap(N,rp,rs);
b0=k0*real(poly(z0));
a0=real(poly(p0));
[H,omega0]=freqs(b0,a0);
dbH=20*log10((abs(H)+eps)/max(abs(H)));
[b1,a1]=lp2bs(b0,a0,w0,bw);
[H1,omega1]=freqs(b1,a1);
dbH1=20*log10((abs(H1)+eps)/max(abs(H1)));

figure(4);
subplot(221);
plot(omega0/(2*pi),dbH);grid;
axis([0,1,-50,1]);
title('归一化模拟低通原型幅度响应');
subplot(222);
plot(omega0/(2*pi),angle(H));grid;
axis([0,1,-4,4]);
title('归一化模拟低通原型相位响应');
subplot(223);
plot(omega1/(2*pi),dbH1);grid;
axis([0,60,-60,1]);
title('实际模拟带阻幅度响应');
subplot(224);
plot(omega1/(2*pi),angle(H1));grid;
axis([0,60,-4,4]);
title('实际模拟带阻相频响应');